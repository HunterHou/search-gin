import{K as re,j as de,f as v,r as K,w as U,g as ce,o as n,c as f,Z as s,S as l,u as a,R as _,T as W,U as j,a as i,ab as pe,ac as me,a6 as Q,F,a7 as P,W as V,a5 as b,Y as y,X as d,O as fe}from"./@vue.4a24e03e.js";import{Q as ye,f as ge,b as ve}from"./index.a5cacb81.js";import{G as he}from"./index.2cefaac2.js";import{g as Ce,a as _e,b as we}from"./ImageUtils.ff957adb.js";import{d as De}from"./@vueuse.ed7761ce.js";import{N as xe,A as Fe,B as g,S as Pe,D as ke,P as Ee,I as Be,a as Ae,b as I,c as Se,R as k,C as q,d as Te,T as G,e as h,f as Le}from"./vant.4222d96e.js";import{a as Ve}from"./vue-router.9e757da4.js";import{M as be}from"./index.ce259e74.js";import{S as Ie}from"./index.5f748ea5.js";import"./axios.40c08a08.js";import"./qs.400ff04d.js";import"./side-channel.7df7083e.js";import"./get-intrinsic.c778f87f.js";import"./has-symbols.72c87504.js";import"./function-bind.2e86ba3a.js";import"./has.c4971d6a.js";import"./call-bind.9e923d7c.js";import"./object-inspect.3624bc6e.js";import"./element-plus.d4b845c0.js";import"./lodash-es.94e8499d.js";import"./@element-plus.83d37beb.js";import"./@ctrl.9375a141.js";import"./dayjs.a7c6d4b1.js";import"./async-validator.73a10b83.js";import"./memoize-one.c87f6fc8.js";import"./escape-html.86960cf8.js";import"./normalize-wheel-es.e2b4fa49.js";import"./@floating-ui.6065d27f.js";import"./pinia.522c8f39.js";import"./pinia-plugin-persist.32a83e37.js";import"./vue3-video-play.17c8eb31.js";import"./@vant.603316c1.js";const qe={class:"mainBody"},Me={style:{"margin-bottom":"10vh"}},ze={style:{"font-size":"12px"}},Ne={id:"videoDiv",style:{width:"100vw",height:"100vh","z-index":"9999",position:"fixed",overflow:"auto","background-color":"rgba(0,0,0,0.7)",float:"left"}},Re={style:{right:"10vw",height:"10vh",position:"absolute","z-index":"9999"}},Oe=d("\u9690\u85CF"),$e=d("\u5173\u95ED"),Ke=d("\u65CB\u8F6C"),Ue={style:{width:"100%",height:"100%","z-index":"99",top:"0px",position:"fixed",overflow:"auto"}},We={style:{right:"1rem",top:"20px",height:"2rem",position:"fixed","z-index":"999"}},je=d("\u5173\u95ED"),Qe=d(' @click.stop="innerVisibleFalse" '),Ge=d("\u505C\u6B62\u64AD\u653E"),Ye={style:{width:"40vw",margin:"8px auto"}},Je={style:{width:"55vw",margin:"8px auto",float:"right"}},Xe={style:{margin:"1px auto"}},Ze=["onClick"],He=d("\u64AD\u653E"),et=d("\u67E5\u770B"),tt={key:0},ot={style:{margin:"1px auto","font-size":"12px",color:"gray","max-height":"3rem"},class:"van-multi-ellipsis--l4"},at=d("\u52A0\u8F7D"),zt=re({__name:"MFileList",setup(st){const{push:Y}=Ve(),{width:J}=De(),M=de(()=>J.value>600),w=v(!1),E=v(!1),B=v(!1),D=v(!1),t=K({settingInfo:new Ie,queryParam:{Page:1,PageSize:10,SortField:"MTime",SortType:"desc",MovieType:"",Keyword:""},loadCnt:0,ModelList:[],TotalCnt:0,ResultCnt:0,videoVisible:!1,currentFile:new be,imageList:[]}),C=K({width:"100%",height:"100%",color:"#409eff",title:"",src:"http://192.168.3.38:8083/api/file/F~emby~emby-rename~\u4E95\u5DDD\u3086\u3044\u67F3\u7530\u3084\u3088\u3044~YeLLOW~[\u5DDD\u3044\u7530\u3088]EO29\u4EBA\u4E2D\u3057\u30F3\u30A3\u30B9\u30C3\u30F3 \u5DDD\u3044\u67F3\u3084\u3044~[\u5DDD\u3044\u7530\u3088][L-8]\u59BB\u51FA\u30D1\u30C6\u30FC\u30C8\u30AD\u30B0\u4E95\u3086 \u7530\u3088{\u9A91}\u8A98\u4E1Dmv[\u5DDD\u3044\u7530\u3088][L-8]\u59BB\u51FA\u30D1\u30C6\u30FC\u30C8\u30AD\u30B0\u4E95\u3086 \u7530\u3088{\u9A91}\u8A98\u4E1Dmv",muted:!1,webFullScreen:!1,speedRate:["0.75","1.0","1.25","1.5","2.0"],autoPlay:!0,loop:!0,mirror:!1,ligthOff:!1,volume:.8,control:!0,controlBtns:["audioTrack","quality","speedRate","volume","setting","pip","pageFullScreen","fullScreen"]});U(w,()=>{console.log("loadingListWatch",w.value)}),U(E,()=>{console.log("finished",E.value)});const x=v(!1),A=v(!1),z=()=>{const u=document.getElementById("videoDiv");u.style.position="fixed",u.style.width="100vw",u.style.height="100vh",A.value?u.style.transform="rotate(90deg)":u.style.transform="rotate(0deg)",A.value=!A.value},X=async()=>{const u=await he();u&&(t.settingInfo={...u})},Z=async()=>{t.queryParam.Page+=1,await O()},S=u=>{t.queryParam.Keyword=u,t.queryParam.Page=1,p()},T=v(!1),H=async u=>{const o=await ge(u);o.Code===200?h.success(o.Message):h.fail(o.Message)},ee=async u=>{const o=h.loading({duration:0,forbidClick:!1,loadingType:"spinner",message:"\u52A0\u8F7D\u4E2D..."});setTimeout(()=>{o.clear()},3e3),await N(u.Id),o.clear(),t.imageList&&t.imageList.length>0?Le({images:t.imageList,closeable:!0}):h.fail("\u65E0\u56FE")},te=async u=>{const o=h.loading({duration:0,forbidClick:!1,loadingType:"spinner",message:"\u52A0\u8F7D\u4E2D..."});setTimeout(()=>{o.clear()},3e3),await N(u.Id),o.clear(),t.imageList&&t.imageList.length>0?T.value=!0:h.fail("\u65E0\u56FE")},oe=()=>{T.value=!1},N=async u=>{const o=await ve(u);if(o&&o.length>0){t.imageList=[];for(let c=0;c<o.length;c++)(o[c].FileType=="jpg"||o[c].FileType=="png")&&t.imageList.push(o[c].ImageBase)}},ae=()=>{t.videoVisible=!1},R=()=>{t.videoVisible=!1,C.src=null,B.value=!1},se=u=>{t.currentFile=u,B.value=!0,t.videoVisible=!0;const o=we(u.Id);console.log(o),C.title=u.Name,C.src=o},O=async u=>{let o={...t.queryParam};u>0&&(o.Page=u,o.PageSize=1);const m=await ye(o);if(!m.Data||m.Data.length==0){E.value=!1;return}m.Data.map(e=>{e.Code==e.Actress&&(e.Code="",e.Actress=""),e.Code.lastIndexOf("-")==e.Code.length-1&&(e.Code=e.Code.substring(0,e.Code.length-1)),e.name=e.Name.trim(),e.Name=e.Name.replace("["+e.Code+"]",""),e.Name=e.Name.replace("["+e.Actress+"]","")});const L=[...t.ModelList,...m.Data];t.ModelList=L,t.TotalCnt=m.TotalCnt,t.ResultCnt=m.ResultCnt,t.loadCnt=t.loadCnt+m.Data.length,D.value=!1,w.value=!1,console.log("queryListOver",w.value)},p=async u=>{t.queryParam.Page=1,t.ModelList=[],t.loadCnt=0,await O()},$=async()=>{console.log("onCancel"),await p()},le=()=>{t.queryParam.Keyword.length>=2&&(t.queryParam.Page=1,p())};ce(()=>{p(),C.src=null,z(),X()});const ue=[{value:"",text:"\u5168\u90E8"},{value:"\u9A91\u5175",text:"\u9A91\u5175"},{value:"\u6B65\u5175",text:"\u6B65\u5175"},{value:"\u65AF\u5DF4\u8FBE",text:"\u65AF\u5DF4\u8FBE"},{value:"\u56FD\u4EA7",text:"\u56FD\u4EA7"}],ie=[{value:"MTime",text:"\u65F6\u95F4\u5012\u6392"},{value:"Name",text:"\u540D\u79F0\u5012\u6392"},{value:"Size",text:"\u5927\u5C0F\u5012\u6392"}],ne=[{value:"desc",text:"\u5012\u6392"},{value:"asc",text:"\u6B63\u6392"}];return(u,o)=>{const c=b("ElButton"),m=b("vue3VideoPlay"),L=b("ElImage");return n(),f("div",qe,[s(a(xe),{title:"\u641C\u7D22","left-text":"\u8FD4\u56DE","left-arrow":"",onClickLeft:o[1]||(o[1]=e=>{a(Y)("/home")})},{right:l(()=>[i("div",{onClick:o[0]||(o[0]=e=>x.value=!0)},[s(a(Be),{name:"search",size:"18"}),i("span",null,y(t.queryParam.Keyword),1)])]),_:1}),s(a(Fe),{show:x.value,"onUpdate:show":o[3]||(o[3]=e=>x.value=e),title:"\u641C\u7D22","close-on-click-overlay":!0},{default:l(()=>[s(a(Ae),{modelValue:t.queryParam.Keyword,"onUpdate:modelValue":[o[2]||(o[2]=e=>t.queryParam.Keyword=e),le],placeholder:"\u8BF7\u8F93\u5165\u641C\u7D22",onSearch:p,label:"\u5173\u952E\u8BCD","show-action":"",onCancel:$,"input-align":"center"},{action:l(()=>[i("div",{onClick:$,style:{margin:"2px 4px"}},"\u641C\u7D22")]),_:1},8,["modelValue"]),i("div",Me,[(n(!0),f(F,null,P(t.settingInfo.Tags,e=>(n(),_(a(g),{type:"warning",plain:"",key:e,style:{margin:"1px 2px"},onClick:r=>{S(e),x.value=!1}},{default:l(()=>[i("span",ze,y(e),1)]),_:2},1032,["onClick"]))),128))])]),_:1},8,["show"]),(n(),_(Q,{to:"body"},[W(i("div",Ne,[i("div",Re,[s(c,{type:"primary",onClick:ae},{default:l(()=>[Oe]),_:1}),s(c,{type:"primary",onClick:R},{default:l(()=>[$e]),_:1}),s(c,{type:"primary",onClick:z},{default:l(()=>[Ke]),_:1})]),s(m,pe(me(C)),null,16)],512),[[j,t.videoVisible]])])),(n(),_(Q,{to:"body"},[W(i("div",Ue,[i("div",We,[s(a(g),{type:"primary",onClick:oe},{default:l(()=>[je]),_:1})]),(n(!0),f(F,null,P(t.imageList,(e,r)=>(n(),f("div",{key:r,style:{display:"flex",margin:"1px auto"}},[s(L,{style:{width:"100%",margin:"0 auto",opacity:"9","z-index":"99"},src:e},{default:l(()=>[Qe]),_:2},1032,["src"])]))),128))],512),[[j,T.value]])])),B.value?(n(),_(a(Pe),{key:0,offsetTop:520,style:{left:"450px",width:"400px"}},{default:l(()=>[s(a(g),{size:"small",type:"success",onClick:o[4]||(o[4]=()=>{t.videoVisible=!0})},{default:l(()=>{var e,r;return[d(" \u6B63\u5728\u64AD\u653E\uFF1A "+y(((e=t.currentFile)==null?void 0:e.Code)||((r=t.currentFile)==null?void 0:r.Actress)||"\u65E0")+" ",1),s(a(g),{size:"small",type:"success",loading:!0,"loading-type":"spinner"})]}),_:1}),s(a(g),{size:"small",type:"danger",onClick:R},{default:l(()=>[Ge]),_:1})]),_:1})):V("",!0),s(a(ke),null,{default:l(()=>[s(a(I),{modelValue:t.queryParam.MovieType,"onUpdate:modelValue":o[5]||(o[5]=e=>t.queryParam.MovieType=e),options:ue,onChange:p},null,8,["modelValue"]),s(a(I),{modelValue:t.queryParam.SortField,"onUpdate:modelValue":o[6]||(o[6]=e=>t.queryParam.SortField=e),options:ie,onChange:p},null,8,["modelValue"]),s(a(I),{modelValue:t.queryParam.SortType,"onUpdate:modelValue":o[7]||(o[7]=e=>t.queryParam.SortType=e),options:ne,onChange:p},null,8,["modelValue"])]),_:1}),s(a(Ee),{modelValue:D.value,"onUpdate:modelValue":o[8]||(o[8]=e=>D.value=e),onRefresh:o[9]||(o[9]=()=>{t.queryParam.Page=1,p(),D.value=!1})},{default:l(()=>[(n(!0),f(F,null,P(t.ModelList,e=>(n(),f("div",{key:e.Id,style:{width:"96vw",float:"left",height:"12rem",margin:"6px 8px",display:"flex","box-shadow":"0 0 4px grey"}},[i("div",Ye,[s(a(Se),{src:a(M)?a(Ce)(e.Id):a(_e)(e.Id),onClick:r=>ee(e),style:fe({height:"100%",width:a(M)?"100%":"auto","max-width":"350px","min-width":"122px",margin:"2px auto"})},null,8,["src","onClick","style"])]),i("div",Je,[i("div",Xe,[s(a(k),{type:"flex",justify:"space-around"},{default:l(()=>[s(a(q),{span:"12"},{default:l(()=>[e.Actress?(n(),f("a",{key:0,onClick:r=>S(e.Actress)},y(e.Actress),9,Ze)):V("",!0)]),_:2},1024),s(a(q),{span:"5"},{default:l(()=>[s(a(g),{square:"",size:"mini",type:"primary",onClick:r=>se(e)},{default:l(()=>[He]),_:2},1032,["onClick"])]),_:2},1024),s(a(q),{span:"5"},{default:l(()=>[s(a(g),{square:"",size:"mini",type:"primary",onClick:r=>te(e)},{default:l(()=>[et]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024),s(a(Te),null,{left:l(()=>[s(a(g),{square:"",size:"mini",type:"danger",onClick:r=>H(e.Id),text:"\u522E\u56FE"},null,8,["onClick"])]),default:l(()=>[s(a(k),null,{default:l(()=>[e.Code?(n(),f("span",tt,y(e.Code),1)):V("",!0),i("span",null,"\u3010"+y(e.SizeStr)+"\u3011 ",1),s(a(G),{color:"#7232dd"},{default:l(()=>[d(y(e.MovieType),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),s(a(k),null,{default:l(()=>[(n(!0),f(F,null,P(e.Tags,r=>(n(),_(a(G),{plain:"",type:"danger",onClick:lt=>S(r)},{default:l(()=>[d(y(r),1)]),_:2},1032,["onClick"]))),256))]),_:2},1024),s(a(k),null,{default:l(()=>[i("div",ot,[i("span",null," \u3010"+y(e.Name)+"\u3011",1)])]),_:2},1024)])])]))),128)),s(a(g),{onClick:Z,block:"",type:"primary"},{default:l(()=>[at]),_:1})]),_:1},8,["modelValue"])])}}});export{zt as default};
